{% extends 'Base_Layout.html.twig' %}

{% block page_identifier %}donation-confirmation{% endblock %}

{% block main %}
	{% set formattedAmount = donation.amount|localizedcurrency('EUR', 'de_DE') %}

	{% if donation.paymentType == 'MCP' or donation.paymentType == 'PPL' or donation.paymentType == 'SUB' %}
		{% include 'partials/donation_confirmation/external_payment.html.twig' %}
	{% elseif donation.paymentType == 'BEZ' %}
		{% include 'partials/donation_confirmation/direct_debit.html.twig' %}
	{% elseif donation.paymentType == 'UEB' %}
		{% include 'partials/donation_confirmation/bank_transfer.html.twig' %}
	{% endif %}

	{% include 'partials/donation_confirmation/membership_information.html.twig' %}

	{% if updateData.message and updateData.isSuccessful != true %}
		<div class="container hidden-print messages">
			<p class="h3">
				{$ updateData.message | trans $}
			</p>
		</div>
	{% endif %}

	{% if featureToggle.donorUpdateEnabled == true and updateData.isSuccessful == false %}
		{% include 'partials/donation/donor_form.html.twig' %}
	{% endif %}

	<img src="https://de.wikipedia.org/wiki/Special:HideBanners?duration={$ donation.cookieDuration $}&reason=donate" width="0" height="0" border="0" />

{% endblock %}

{% block scripts %}
	<script src="{$ basepath|e('html_attr') $}{$ '/skins/cat17/scripts/wmde.js'|prefix_file $}"></script>
	<script src="{$ basepath|e('html_attr') $}{$ '/skins/cat17/scripts/donation_confirmation.js'|prefix_file $}"></script>
	<script id="init-form" src="{$ basepath|e('html_attr') $}{$ '/skins/cat17/scripts/donorUpdateForm.js'|prefix_file $}"
			data-initial-form-values="{% if initialFormValues %}{$ initialFormValues|json_encode|e('html_attr') $}{% else %}{}{% endif %}"
			data-violated-fields="{% if violatedFields %}{$ violatedFields|json_encode|e('html_attr') $}{% else %}{}{% endif %}"
			data-initial-validation-result="{% if validationResult %}{$ validationResult|json_encode|e('html_attr') $}{% else %}{}{% endif %}"
			data-validate-amount-url="{$ basepath | e( 'html_attr' ) $}/validate-donation-amount"
			data-validate-address-url="{$ basepath|e('html_attr') $}/validate-address"
			data-validate-email-address-url="{$ basepath|e('html_attr') $}/validate-email"
			data-validate-iban-url="{$ basepath|e('html_attr') $}/check-iban"
			data-generate-iban-url="{$ basepath|e('html_attr') $}/generate-iban"
	></script>
{% endblock %}
